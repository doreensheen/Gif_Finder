<!DOCtype>
<html lang="en-us">

    <head>
        <meta charset="utf=8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Gif Finder</title>

        <!-- css reset -->
        <link rel="stylesheet" href="./assets/css/reset.css">
        <!-- bootstrap 4-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <!-- css styles -->
        <link rel="stylesheet" href="./assets/css/style.css">

        <!-- jQuery -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    </head>

    <body>
        <nav class="navbar navbar-light bg-light">
            <div class="container form-inline">
                <a class="navbar-brand text-primary" style="font-size: 20pt;" href="#!">Gif Finder</a>
                <form class="form-inline input-group" role="search">
                    <input type="text" id="newEmotion" class="form-control" placeholder="Add an Emotion">
                    <div class="input-group-append">
                        <button type="submit" id="submitButton" class="btn btn-primary">Submit</button>
                    </div>
                </form>
            </div>
        </nav>  
        <br>
        <div class="container">
            <div id="buttonHolder" class="row"></div><br>

            <div id="gifHolder" class="card-columns"></div>
        </div>


        <!-- JS Script -->
        <script>
        $(document).ready(function() {
            // -----------------------------------------------------------------------------------
            // function calls api and displays relevent gifs when an emotion button is clicked
            function findGifs() {
                $(".gifButton").on("click", function() {
                    // empty div #gifHolder
                    $("#gifHolder").html("");

                    // call gifhy api
                    var emotion = $(this).attr("data-value");
                    var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
                    emotion + "&api_key=dc6zaTOxFJmzC" + "&limit=10";
                    
                    // retreive data from api
                    $.ajax({
                        url: queryURL,
                        method: "GET"
                    }).then(function(response) {
                        // return 10 items from data array
                        for (j=0; j<10; j++) {
                            var itemRating = response.data[j].rating;
                            var itemGif = $("<img>");
                            itemGif.attr("src", response.data[j].images.fixed_height.url);
                            itemGif.attr("class", "card-img-top")
                            // display to html
                            var card = $("<div>");
                            card.attr("class", "card inline-block");

                            var cardBody = $("<div>");
                            cardBody.attr("class", "card-footer bg-white")

                            card.append(itemGif);
                            card.append(cardBody.append("Rating: " + itemRating));
                            $("#gifHolder").prepend(card);
                        };
                    });

                });

            };
            // ------------------------------------------------------------------------------------
            // create array to hold emotions
            emotionArray = ["Joy", "Trust", "Fear", "Surprise", "Sadness", "Disgust", "Anger", "Anticipation"]
            
            // create emotion buttons dynamically
            for (i=0; i<emotionArray.length; i++) {
                var gifButton = $("<button>");
                $("#buttonHolder").append(gifButton.text(emotionArray[i]));
                gifButton.attr("class", "gifButton btn btn-success");
                gifButton.attr("data-value", emotionArray[i]);
            };
                
            // add new emotion button
            $("#submitButton").on("click", function(event) {
                event.preventDefault();
                var inputText = $("#newEmotion").val();
                emotionArray.push(inputText);
                var newGifButton = $("<button>");
                $("#buttonHolder").append(newGifButton.text(inputText));
                newGifButton.attr("class", "gifButton btn btn-success");
                newGifButton.attr("id", "test");
                newGifButton.attr("data-value", inputText);
                
                findGifs();
            });

            findGifs();

        });
        </script>
    </body>

</html>